id: translate-app
name: Translate
version: 0.1.0
type: app
license: MIT
icon: ChatBubbleTranslate
color: success
description: Translate text between different languages.
author:
  name: Arnaud Leymet
  url: https://arnley.com
privacyPolicy: https://devs.new/privacy
source: https://github.com/codename-co/devs/blob/main/public/extensions/translate-app.extension.yaml
screenshots:
  - data:image/webp;base64,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
i18n:
  en:
    name: Translate
    description: Translate text between different languages.
    messages:
      from: From
      to: To
      swapLanguages: Swap languages
      placeholder: Enter text to translate…
      translate: Translate
      translation: Translation
      translationFailed: 'Translation failed: '
      lang_eng: English
      lang_fra: French
      lang_deu: German
      lang_spa: Spanish
      lang_ita: Italian
      lang_por: Portuguese
      lang_nld: Dutch
      lang_rus: Russian
      lang_jpn: Japanese
      lang_zho: Chinese
      lang_kor: Korean
      lang_ara: Arabic
  ar:
    name: الترجمة
    description: ترجم النص بين لغات مختلفة.
    messages:
      from: من
      to: إلى
      swapLanguages: تبديل اللغات
      placeholder: أدخل النص للترجمة…
      translate: ترجم
      translation: الترجمة
      translationFailed: 'فشلت الترجمة: '
      lang_eng: الإنجليزية
      lang_fra: الفرنسية
      lang_deu: الألمانية
      lang_spa: الإسبانية
      lang_ita: الإيطالية
      lang_por: البرتغالية
      lang_nld: الهولندية
      lang_rus: الروسية
      lang_jpn: اليابانية
      lang_zho: الصينية
      lang_kor: الكورية
      lang_ara: العربية
  de:
    name: Übersetzung
    description: Übersetzen Sie Text zwischen verschiedenen Sprachen.
    messages:
      from: Von
      to: Nach
      swapLanguages: Sprachen tauschen
      placeholder: Text zum Übersetzen eingeben…
      translate: Übersetzen
      translation: Übersetzung
      translationFailed: 'Übersetzung fehlgeschlagen: '
      lang_eng: Englisch
      lang_fra: Französisch
      lang_deu: Deutsch
      lang_spa: Spanisch
      lang_ita: Italienisch
      lang_por: Portugiesisch
      lang_nld: Niederländisch
      lang_rus: Russisch
      lang_jpn: Japanisch
      lang_zho: Chinesisch
      lang_kor: Koreanisch
      lang_ara: Arabisch
  es:
    name: Traducción
    description: Traduce texto entre diferentes idiomas.
    messages:
      from: De
      to: A
      swapLanguages: Intercambiar idiomas
      placeholder: Ingresa el texto a traducir…
      translate: Traducir
      translation: Traducción
      translationFailed: 'Error en la traducción: '
      lang_eng: Inglés
      lang_fra: Francés
      lang_deu: Alemán
      lang_spa: Español
      lang_ita: Italiano
      lang_por: Portugués
      lang_nld: Neerlandés
      lang_rus: Ruso
      lang_jpn: Japonés
      lang_zho: Chino
      lang_kor: Coreano
      lang_ara: Árabe
  fr:
    name: Traduction
    description: Traduisez du texte entre différentes langues.
    messages:
      from: De
      to: Vers
      swapLanguages: Inverser les langues
      placeholder: Saisissez le texte à traduire…
      translate: Traduire
      translation: Traduction
      translationFailed: 'Échec de la traduction : '
      lang_eng: Anglais
      lang_fra: Français
      lang_deu: Allemand
      lang_spa: Espagnol
      lang_ita: Italien
      lang_por: Portugais
      lang_nld: Néerlandais
      lang_rus: Russe
      lang_jpn: Japonais
      lang_zho: Chinois
      lang_kor: Coréen
      lang_ara: Arabe
  ko:
    name: 번역
    description: 다양한 언어 간에 텍스트를 번역합니다.
    messages:
      from: 원본
      to: 대상
      swapLanguages: 언어 교환
      placeholder: 번역할 텍스트를 입력하세요…
      translate: 번역하기
      translation: 번역 결과
      translationFailed: '번역 실패: '
      lang_eng: 영어
      lang_fra: 프랑스어
      lang_deu: 독일어
      lang_spa: 스페인어
      lang_ita: 이탈리아어
      lang_por: 포르투갈어
      lang_nld: 네덜란드어
      lang_rus: 러시아어
      lang_jpn: 일본어
      lang_zho: 중국어
      lang_kor: 한국어
      lang_ara: 아랍어

pages:
  'translate': | # jsx
    import { Button, Textarea, Select, SelectItem, Tooltip, Card, CardBody, Section, PromptArea } from '@devs/components';
    import { create } from 'https://esm.sh/zustand@5?standalone&external=react,react-dom';
    import { franc } from 'https://esm.sh/franc@6?standalone';

    const { t } = window.DEVS;

    const languages = [
      { code: 'eng', labelKey: 'lang_eng' },
      { code: 'fra', labelKey: 'lang_fra' },
      { code: 'deu', labelKey: 'lang_deu' },
      { code: 'spa', labelKey: 'lang_spa' },
      { code: 'ita', labelKey: 'lang_ita' },
      { code: 'por', labelKey: 'lang_por' },
      { code: 'nld', labelKey: 'lang_nld' },
      { code: 'rus', labelKey: 'lang_rus' },
      { code: 'jpn', labelKey: 'lang_jpn' },
      { code: 'zho', labelKey: 'lang_zho' },
      { code: 'kor', labelKey: 'lang_kor' },
      { code: 'ara', labelKey: 'lang_ara' },
    ];

    const useTranslateStore = create((set) => ({
      sourceText: '',
      targetText: '',
      sourceLang: 'eng',
      targetLang: 'fra',
      isLoading: false,
      setSourceText: (text) => set({ sourceText: text }),
      setTargetText: (text) => set({ targetText: text }),
      setSourceLang: (lang) => set({ sourceLang: lang }),
      setTargetLang: (lang) => set({ targetLang: lang }),
      setLoading: (loading) => set({ isLoading: loading }),
      swap: () => set((state) => ({
        sourceLang: state.targetLang,
        targetLang: state.sourceLang,
        sourceText: state.targetText,
        targetText: state.sourceText,
      })),
    }));

    const App = () => {
      const {
        sourceText, targetText, sourceLang, targetLang, isLoading,
        setSourceText, setTargetText, setSourceLang, setTargetLang, setLoading, swap
      } = useTranslateStore();

      const detectLanguage = () => {
        if (sourceText.length > 10) {
          const detected = franc(sourceText);
          if (detected !== 'und') {
            setSourceLang(detected);
          }
        }
      };

      const PROMPT = `You are a professional {SOURCE_LANG} ({SOURCE_CODE}) to {TARGET_LANG} ({TARGET_CODE}) translator. Your goal is to accurately convey the meaning and nuances of the original {SOURCE_LANG} text while adhering to {TARGET_LANG} grammar, vocabulary, and cultural sensitivities.\nProduce only the {TARGET_LANG} translation, without any additional explanations or commentary. Please translate the following {SOURCE_LANG} text into {TARGET_LANG}:`

      const handleTranslate = async () => {
        if (!sourceText.trim()) return;
        setLoading(true);

        const sourceName = t(languages.find(l => l.code === sourceLang)?.labelKey || 'lang_eng');
        const targetName = t(languages.find(l => l.code === targetLang)?.labelKey || 'lang_fra');

        try {
          const response = await window.DEVS.llm.chat([
            {
              role: 'system',
              content:
                PROMPT.replaceAll('{SOURCE_LANG}', sourceName)
                  .replaceAll('{SOURCE_CODE}', sourceLang)
                  .replaceAll('{TARGET_LANG}', targetName)
                  .replaceAll('{TARGET_CODE}', targetLang)
            },
            { role: 'user', content: sourceText }
          ], { temperature: 0.3 });
          setTargetText(response.content);
        } catch (error) {
          setTargetText(t('translationFailed') + error.message);
        }
        setLoading(false);
      };

      const swapLanguages = () => swap();

      return (
        <Section>
          <div className="flex items-center gap-4">
            <Select
              label={t('from')}
              selectedKeys={[sourceLang]}
              onSelectionChange={(keys) => setSourceLang([...keys][0])}
              className="flex-1"
            >
              {languages.map((lang) => (
                <SelectItem key={lang.code}>{t(lang.labelKey)}</SelectItem>
              ))}
            </Select>

            <Tooltip content={t('swapLanguages')}>
              <Button
                variant="light"
                onClick={swapLanguages}
              >
                ⇄
              </Button>
            </Tooltip>

            <Select
              label={t('to')}
              selectedKeys={[targetLang]}
              onSelectionChange={(keys) => setTargetLang([...keys][0])}
              className="flex-1"
            >
              {languages.map((lang) => (
                <SelectItem key={lang.code}>{t(lang.labelKey)}</SelectItem>
              ))}
            </Select>
          </div>

          <div className="flex gap-4">
            <Card className="flex-1">
              <CardBody>
                <PromptArea
                  placeholder={t('placeholder')}
                  value={sourceText}
                  onValueChange={setSourceText}
                  onSubmit={handleTranslate}
                  isLoading={isLoading}
                  submitLabel={t('translate')}
                  onChange={detectLanguage}
                  minRows={6}
                />
              </CardBody>
            </Card>

            <Card className="flex-1">
              <CardBody>
                <Textarea
                  placeholder={t('translation')}
                  value={targetText}
                  onValueChange={setTargetText}
                  minRows={6}
                  isReadOnly
                />
              </CardBody>
            </Card>
          </div>
        </Section>
      );
    }
